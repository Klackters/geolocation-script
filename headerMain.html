<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
</head>

<body>
  <div class="header-banner-geolocation-container"></div>
  <script>

    // Define variável global
    var cidade = "";

    // Verifica se a cidade está armazenada nos cookies
    async function fetchCity() {

      var cidadeCookie = Cookies.get('cidade');
      console.log("Cookie armazenado", cidadeCookie);
      adBannerRenderWithoutCity();

      if (!cidadeCookie) {
        obterCidade();
      } else {
        console.log("API da Google NÃO FOI utilizada")
        cidade = cidadeCookie;
        adBannerRender();
      }
    }

    // Envia requisição à API Mapbox e retorna a cidade do usuário
    function obterCidade() {
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(function (position) {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;

          const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${longitude},${latitude}.json?access_token=pk.eyJ1IjoiYnJlbm9kbXgiLCJhIjoiY2xpajh0N2MzMDUyODNsbGc2dTJyOTE3cyJ9.6XjNOwVMR5aO5i9qPVWevw`;

          fetch(url)
            .then(response => response.json())
            .then(data => {
              cidade = data.features[0].context.find(context => context.id.startsWith('place')).text;
              Cookies.set('cidade', cidade);
              console.log(cidade);
              // Funções a serem recarregadas quando o usuário permitir acesso à localização
              clearHTMLSquare();
              addAdvertisementRectangle();
              addAdvertisementSquarePapoEspecialista();
              addAdvertisementFooter();
            })
            .catch(error => {
              console.error("Erro ao obter a cidade:", error);
              adBannerRenderWithoutCity();
            });

        });
      } else {
        console.log("Geolocalização não suportada");
        adBannerRenderWithoutCity();
      }
    }

    // Renderiza o banner de anúncio sem cidade quando o usuário acessa o site sem permissão de localização
    function adBannerRenderWithoutCity() {
      const bannerSelectorHeader = '.header-banner-geolocation-container';
      const adContentBannerHeader = `
      <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19486&t=1685705096" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
      `

      $(bannerSelectorHeader).empty();

      $(bannerSelectorHeader).append(adContentBannerHeader);
      console.log("Banner sem cidade renderizado");
    }

    // Limpa (reseta) e renderiza o banner de anúncio do Header baseado na cidade do usuário
    function adBannerRender() {
      var adContentBannerHeader = ``;

      const bannerSelectorHeader = '.header-banner-geolocation-container';
      $(bannerSelectorHeader).empty();
      function addAdvertisement() {

        $(bannerSelectorHeader).empty();
        $(bannerSelectorHeader).append(adContentBannerHeader);
        console.log("Banner do header gerado na cidade: ", cidade)
      }

      // Série de verificações para encontrar o bloco referente à cidade do usuário
      if (cidade.toUpperCase() === "AMERICANA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19628&t=1685714948" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ARTUR NOGUEIRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19629&t=1685715529" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CAMPINAS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19605" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "COSMÓPOLIS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19630&t=1685715579" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ENGENHEIRO COELHO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19631&t=1685715616" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "HOLAMBRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19632&t=1685715673" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "HORTOLÂNDIA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19633&t=1685715707" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "INDAIATUBA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19634&t=1685715764" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ITATIBA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19635&t=1685715801" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "JAGUARIÚNA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19636&t=1685715845" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "MONTE MOR") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19637&t=1685715887" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "MORUNGABA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19638&t=1685715932" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "NOVA ODESSA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19639&t=1685715982" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PAULÍNIA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19640&t=1685716012" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PEDREIRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19641&t=1685716045" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA BÁRBARA D'OESTE") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19642&t=1685716074" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTO ANTÔNIO DE POSSE") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19643&t=1685716184" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SUMARÉ") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19644&t=1685716221" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "VALINHOS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19645&t=1685716283" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "VINHEDO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19646&t=1685716320" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ÁGUAS DE SÃO PEDRO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19647&t=1685716361" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ANALÂNDIA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19648&t=1685716397" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ARARAS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19649&t=1685716430" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CAPIVARI") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19650&t=1685716490" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CHARQUEADA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19651&t=1685716531" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CONCHAL") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19652&t=1685716569" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CORDEIRÓPOLIS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19653&t=1685716597" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CORUMBATAÍ") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19654&t=1685716962" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ELIAS FAUSTO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19655&t=1685716989" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "IPEÚNA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19656&t=1685717023" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "IRACEMÁPOLIS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19657&t=1685717061" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "LEME") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19658&t=1685717250" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "LIMEIRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19659&t=1685717283" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "MOMBUCA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19660&t=1685717310" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PIRACICABA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19661&t=1685717357" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PIRASSUNUNGA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19662&t=1685717391" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "RAFARD") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19663&t=1685717419" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "RIO CLARO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19664&t=1685717453" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "RIO DAS PEDRAS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19665&t=1685717482" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SALTINHO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19666&t=1685717509" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA CRUZ DA CONCEIÇÃO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19667&t=1685717544" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA GERTRUDES") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19668&t=1685717572" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA MARIA DA SERRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19669&t=1685717631" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SÃO PEDRO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19670&t=1685717659" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);
      }
    }

    // Primeira chamada de função no DOM
    fetchCity();

  </script>
</body>