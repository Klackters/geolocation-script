<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"></script>
</head>

<body>
  <div class="header-banner-geolocation-container"></div>
  <script>

    // Define variável global
    var cidade = "";

    // Verifica se a cidade está armazenada nos cookies
    async function fetchCity() {

      var cidadeCookie = Cookies.get('cidade');
      console.log("Cookie armazenado", cidadeCookie);
      adBannerRenderWithoutCity();

      if (!cidadeCookie) {
        obterCidade();
      } else {
        console.log("API da Google NÃO FOI utilizada")
        cidade = cidadeCookie;
        adBannerRender();
      }
    }

    // Envia requisição à API Mapbox e retorna a cidade do usuário
    function obterCidade() {
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(function (position) {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;
          const url = `https://api.mapbox.com/geocoding/v5/mapbox.places/${longitude},${latitude}.json?access_token=pk.eyJ1IjoiYnJlbm9kbXgiLCJhIjoiY2xpajh0N2MzMDUyODNsbGc2dTJyOTE3cyJ9.6XjNOwVMR5aO5i9qPVWevw`;

          fetch(url)
            .then(response => response.json())
            .then(data => {
              cidade = data.features[0].context.find(context => context.id.startsWith('place')).text;
              Cookies.set('cidade', cidade);
              console.log(cidade);
              // Funções a serem recarregadas quando o usuário permitir acesso à localização
              addAdvertisementFooter();
              addAdvertisementHalfPage();
            })
            .catch(error => {
              console.error("Erro ao obter a cidade:", error);
              adBannerRenderWithoutCity();
            });
        });
      } else {
        console.log("Geolocalização não suportada");
        adBannerRenderWithoutCity();
      }
    }

    // Renderiza o banner de anúncio sem cidade quando o usuário acessa o site sem permissão de localização
    function adBannerRenderWithoutCity() {
      const bannerSelectorHeader = '.header-banner-geolocation-container';
      const adContentBannerHeader = `
      <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policial.dmxdesign.com.br?_dnid=19486&t=1685705096" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
      `
      $(bannerSelectorHeader).empty();
      $(bannerSelectorHeader).append(adContentBannerHeader);
      console.log("Banner sem cidade renderizado");
    }

    // Limpa (reseta) e renderiza o banner de anúncio do Header baseado na cidade do usuário
    function adBannerRender() {
      var adContentBannerHeader = ``;
      const bannerSelectorHeader = '.header-banner-geolocation-container';
      $(bannerSelectorHeader).empty();
      function addAdvertisement() {
        $(bannerSelectorHeader).empty();
        $(bannerSelectorHeader).append(adContentBannerHeader);
        console.log("Banner do header gerado na cidade: ", cidade);
      }

      // Série de verificações para encontrar o bloco referente à cidade do usuário
      if (cidade.toUpperCase() === "AMERICANA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38153&t=1686564057" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ARTUR NOGUEIRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38154&t=1686564110" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CAMPINAS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38152&t=1686564181" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "COSMÓPOLIS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38155&t=1686564234" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ENGENHEIRO COELHO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38156&t=1686564636" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "HOLAMBRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38157&t=1686564657" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "HORTOLÂNDIA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38158&t=1686564694" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "INDAIATUBA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38159&t=1686564711" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ITATIBA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38160&t=1686564740" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "JAGUARIÚNA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38161&t=1686564769" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "MONTE MOR") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38162&t=1686564797" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "MORUNGABA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38163&t=1686564829" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "NOVA ODESSA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38164&t=1686564858" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PAULÍNIA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38165&t=1686564881" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PEDREIRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38166&t=1686564902" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA BÁRBARA D'OESTE") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38167&t=1686564922" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTO ANTÔNIO DE POSSE") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38168&t=1686564945" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SUMARÉ") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38169&t=1686564967" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "VALINHOS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38170&t=1686564999" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "VINHEDO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38171&t=1686565035" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ÁGUAS DE SÃO PEDRO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38172&t=1686565096" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ANALÂNDIA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38173&t=1686565115" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ARARAS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38174&t=1686565135" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CAPIVARI") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38175&t=1686565158" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CHARQUEADA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38176&t=1686565196" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CONCHAL") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38177&t=1686565223" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CORDEIRÓPOLIS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38178&t=1686565244" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "CORUMBATAÍ") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38179&t=1686565262" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "ELIAS FAUSTO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38180&t=1686565298" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "IPEÚNA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38181&t=1686565317" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "IRACEMÁPOLIS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38182&t=1686565343" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "LEME") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38183&t=1686565363" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "LIMEIRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38184&t=1686565382" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "MOMBUCA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38185&t=1686565423" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PIRACICABA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38186&t=1686565443" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "PIRASSUNUNGA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38187&t=1686565461" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "RAFARD") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38188&t=1686565489" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "RIO CLARO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38189&t=1686565512" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "RIO DAS PEDRAS") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38190&t=1686565532" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SALTINHO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38191&t=1686565555" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA CRUZ DA CONCEIÇÃO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38192&t=1686565578" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA GERTRUDES") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38193&t=1686565601" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SANTA MARIA DA SERRA") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38194&t=1686565622" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);

      } else if (cidade.toUpperCase() === "SÃO PEDRO") {
        adContentBannerHeader = `
        <div style="max-width:970px; width:100%; height:250px;"><iframe src="https://policialpadrao.com.br?_dnid=38195&t=1686565642" border="0" scrolling="no" allowtransparency="true" style="width:1px;min-width:100%;*width:100%;height:100%;border:0;"></iframe></div>
        `
        addAdvertisement(adContentBannerHeader);
      }
    }

    // Primeira chamada de função no DOM
    fetchCity();

  </script>
</body>